<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø±Ø§Ø¯Ø§Ø± Ø§Ù„Ø£Ø®Ø¨Ø§Ø± - Ø¨Ø« Ù…Ø¨Ø§Ø´Ø± Ø¨ØµÙˆØª</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        body { margin: 0; display: flex; height: 100vh; font-family: 'Segoe UI', Tahoma, sans-serif; background: #eee; overflow: hidden; }
        #sidebar { width: 380px; background: #ffffff; border-left: 1px solid #ccc; overflow-y: auto; display: flex; flex-direction: column; box-shadow: 2px 0 10px rgba(0,0,0,0.1); z-index: 1000; }
        .header { background: #d32f2f; color: white; padding: 20px; text-align: center; font-size: 1.2em; font-weight: bold; position: sticky; top: 0; z-index: 10; }
        .news-item { padding: 15px; border-bottom: 1px solid #f0f0f0; cursor: pointer; transition: all 0.2s; text-decoration: none; color: inherit; display: block; }
        .news-item:hover { background: #fff5f5; border-right: 5px solid #d32f2f; }
        .news-item h4 { margin: 0 0 5px 0; color: #333; font-size: 1.1em; line-height: 1.3; }
        #map { flex-grow: 1; }
        /* Ø²Ø± ØªÙØ¹ÙŠÙ„ Ø§Ù„ØµÙˆØª */
        #audio-btn { position: absolute; top: 10px; right: 60px; z-index: 1000; background: white; border: 2px solid #d32f2f; padding: 5px 10px; cursor: pointer; border-radius: 5px; }
    </style>
</head>
<body>

    <button id="audio-btn" onclick="enableAudio()">ğŸ”Š ØªÙØ¹ÙŠÙ„ ØµÙˆØª Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡</button>

    <div id="sidebar">
        <div class="header">ğŸ”´ Ø±Ø§Ø¯Ø§Ø± Ø§Ù„Ø£Ø®Ø¨Ø§Ø± Ø§Ù„Ù…Ø¨Ø§Ø´Ø±</div>
        <div id="news-list">
            <p style="text-align:center; padding:20px;">Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø£Ø®Ø¨Ø§Ø±...</p>
        </div>
    </div>

    <div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>

    <script>
        var map = L.map('map').setView([25.0, 45.0], 4); 
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

        const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSwHGhFEF1yL4wxSzY3tlFFIPIvjLDkEfTrQwg4dQgr3IJNzwBANp7QOS5gkQthMnKwgfExwt_gL1Lu/pub?output=csv';
        
        // ØµÙˆØª Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡
        const notificationSound = new Audio('https://assets.mixkit.co/active_storage/sfx/2358/2358-preview.mp3');
        let lastNewsCount = 0;
        let audioEnabled = false;

        function enableAudio() {
            audioEnabled = true;
            document.getElementById('audio-btn').style.background = '#d32f2f';
            document.getElementById('audio-btn').style.color = 'white';
            document.getElementById('audio-btn').innerText = 'ğŸ”” Ø§Ù„ØµÙˆØª ÙŠØ¹Ù…Ù„';
        }

        function fetchNews() {
            Papa.parse(csvUrl, {
                download: true,
                header: true,
                complete: function(results) {
                    const data = results.data.filter(row => row.Title);
                    const listContainer = document.getElementById('news-list');
                    
                    // Ø¥Ø°Ø§ Ø²Ø§Ø¯ Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø®Ø¨Ø§Ø± Ø¹Ù† Ø§Ù„Ù…Ø±Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©ØŒ Ø£ØµØ¯Ø± ØµÙˆØªØ§Ù‹
                    if (audioEnabled && data.length > lastNewsCount && lastNewsCount !== 0) {
                        notificationSound.play();
                    }
                    lastNewsCount = data.length;

                    listContainer.innerHTML = ''; 
                    data.forEach(item => {
                        const title = item.Title || item.title;
                        const link = item.Link || item.link || '#';
                        
                        const a = document.createElement('a');
                        a.className = 'news-item';
                        a.href = link;
                        a.target = '_blank';
                        a.innerHTML = `<h4>${title}</h4>`;
                        listContainer.appendChild(a);
                        
                        L.marker([20 + Math.random()*15, 30 + Math.random()*20]).addTo(map)
                         .bindPopup(`<b>${title}</b>`);
                    });
                }
            });
        }

        fetchNews();
        setInterval(fetchNews, 60000); // ØªØ­Ø¯ÙŠØ« ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø©
    </script>
</body>
</html>


